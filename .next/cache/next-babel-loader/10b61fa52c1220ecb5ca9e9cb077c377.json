{"ast":null,"code":"var _jsxFileName = \"/home/charlie/MEGAsync/Ingenieria Sistemas/DECIMO SEMESTRE/Etica/app-ley842/pages-sections/LandingPage-Sections/user/LawSection.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from \"react\"; // @material-ui/core components\n\nimport { makeStyles } from \"@material-ui/core/styles\"; // core components\n\nimport GridContainer from \"../../../components/Grid/GridContainer\";\nimport GridItem from \"../../../components/Grid/GridItem\";\nimport Button from \"../../../components/Button\";\nimport styles from \"../../../assets/jss/nextjs-material-kit/pages/landingPageSections/user/lawStyles\";\nimport { FormControl, FormControlLabel, RadioGroup, Radio } from \"@material-ui/core\";\nimport CustomInput from \"../../../components/CustomInput\";\nimport { Search } from \"@material-ui/icons\";\nimport Title from \"../../../components/etihcs/Title\";\nimport { executeQuery } from \"../../../plugins/graphqlQueryRequest\";\nimport { searchQuery } from \"../../../utils/queries\";\nimport { searchTitleQuery, searchChapterQuery, searchArticleQuery } from '../../../utils/queries';\nimport { map, forEach, get, findIndex, unionBy } from \"lodash\";\nimport fetch from 'node-fetch';\nimport { API_URL, CLIENT_ID } from \"../../../utils/constants\";\nconst useStyles = makeStyles(styles);\nvar SearchValue;\n\n(function (SearchValue) {\n  SearchValue[\"TITLE\"] = \"title\";\n  SearchValue[\"CHAPTER\"] = \"chapter\";\n  SearchValue[\"ARTICLE\"] = \"article\";\n})(SearchValue || (SearchValue = {}));\n\nconst searchLawContent = () => {\n  const {\n    data\n  } = executeQuery(searchQuery);\n\n  if (data && data.titles) {\n    return data.titles;\n  }\n};\n\nexport default function LawSection() {\n  const classes = useStyles();\n  const {\n    0: searchValue,\n    1: setSearchValue\n  } = useState(SearchValue.TITLE);\n  const {\n    0: searchQuery,\n    1: setSearchQuery\n  } = useState(searchTitleQuery);\n  const {\n    0: searchText,\n    1: setSearchText\n  } = useState('');\n  const {\n    0: searched,\n    1: setSearched\n  } = useState(searchLawContent());\n\n  const handleRadioChange = event => {\n    const value = event.target.value;\n    if (value === SearchValue.TITLE) setSearchQuery(searchTitleQuery);else if (value === SearchValue.CHAPTER) setSearchQuery(searchChapterQuery);else if (value === SearchValue.ARTICLE) setSearchQuery(searchArticleQuery);\n    setSearchValue(value);\n  };\n\n  const handlerSearch = async () => {\n    try {\n      const response = await fetch(`${API_URL}`, {\n        method: 'POST',\n        body: JSON.stringify({\n          query: searchQuery,\n          variables: {\n            text: searchText\n          }\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json',\n          'Authorization': `client_id ${CLIENT_ID}`\n        }\n      }).then(res => res.json());\n\n      if (response.data) {\n        const data = response.data;\n        if (searchValue === SearchValue.TITLE) setSearched(data.titles);else if (searchValue === SearchValue.CHAPTER) {\n          let setData = [];\n          forEach(data.chapters, chapter => {\n            if (get(chapter, `title.id`)) {\n              const index = findIndex(setData, {\n                id: get(chapter, `title.id`)\n              });\n              if (index !== -1) setData[index].chapters = unionBy(setData[index].chapters, [_objectSpread({}, chapter)], 'id');else setData = unionBy(setData, [_objectSpread({}, chapter.title, {\n                chapters: [_objectSpread({}, chapter)]\n              })], 'id');\n            }\n          });\n          setSearched(setData);\n        } else if (searchValue === SearchValue.ARTICLE) {\n          const setChapterData = (chapters, article) => {\n            const index = findIndex(chapters, {\n              id: get(article, `chapter.id`)\n            });\n\n            if (index !== -1) {\n              chapters[index].articles = unionBy(chapters[index].articles, [_objectSpread({}, article)], 'id');\n              return chapters;\n            } else return unionBy(chapters, [_objectSpread({}, article.chapter, {\n              articles: [_objectSpread({}, article)]\n            })], 'id');\n          };\n\n          let setData = [];\n          forEach(data.articles, article => {\n            if (get(article, `chapter.title.id`)) {\n              const indexTitle = findIndex(setData, {\n                id: get(article, `chapter.title.id`)\n              });\n              if (indexTitle !== -1) setData[indexTitle].chapters = setChapterData(setData[indexTitle].chapters, article);else setData = unionBy(setData, [_objectSpread({}, article.chapter.title, {\n                chapters: setChapterData([], article)\n              })], 'id');\n            }\n          });\n          setSearched(setData);\n        }\n      }\n    } catch (error) {\n      console.log('Error: ', error.message);\n    }\n  };\n\n  const handlerSearchText = event => {\n    setSearchText(event.target.value);\n  };\n\n  if (searched) {\n    return __jsx(\"div\", {\n      className: classes.section,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 127,\n        columnNumber: 13\n      }\n    }, __jsx(\"h1\", {\n      className: classes.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 17\n      }\n    }, \"B\\xFAsqueda\"), __jsx(GridContainer, {\n      justify: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }\n    }, __jsx(GridItem, {\n      xs: 12,\n      sm: 12,\n      md: 8,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 21\n      }\n    }, __jsx(FormControl, {\n      component: \"fieldset\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 25\n      }\n    }, __jsx(RadioGroup, {\n      row: true,\n      \"aria-label\": \"search\",\n      name: \"search\",\n      value: searchValue,\n      onChange: handleRadioChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 29\n      }\n    }, __jsx(FormControlLabel, {\n      value: \"title\",\n      control: __jsx(Radio, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 46\n        }\n      }),\n      label: \"Titulo\",\n      labelPlacement: \"bottom\",\n      classes: {\n        label: classes.label,\n        root: classes.labelRoot\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 134,\n        columnNumber: 33\n      }\n    }), __jsx(FormControlLabel, {\n      value: \"chapter\",\n      control: __jsx(Radio, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 146,\n          columnNumber: 46\n        }\n      }),\n      label: \"Capitulo\",\n      labelPlacement: \"bottom\",\n      classes: {\n        label: classes.label,\n        root: classes.labelRoot\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 33\n      }\n    }), __jsx(FormControlLabel, {\n      value: \"article\",\n      control: __jsx(Radio, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 46\n        }\n      }),\n      label: \"Articulo\",\n      labelPlacement: \"bottom\",\n      classes: {\n        label: classes.label,\n        root: classes.labelRoot\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 33\n      }\n    }))))), __jsx(GridContainer, {\n      justify: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 17\n      }\n    }, __jsx(GridItem, {\n      xs: 12,\n      sm: 12,\n      md: 12,\n      lg: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 21\n      }\n    }, __jsx(CustomInput, {\n      labelText: \"B\\xFAscar\",\n      id: \"material\",\n      onChange: handlerSearchText,\n      formControlProps: {\n        fullWidth: true\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 25\n      }\n    }), __jsx(Button, {\n      justIcon: true,\n      round: true,\n      color: \"white\",\n      onClick: handlerSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 25\n      }\n    }, __jsx(Search, {\n      className: classes.searchIcon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 29\n      }\n    })))), __jsx(GridContainer, {\n      className: classes.gridScroll,\n      justify: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 17\n      }\n    }, map(searched, ({\n      id,\n      number,\n      name,\n      chapters\n    }) => {\n      return __jsx(GridItem, {\n        key: id,\n        xs: 12,\n        sm: 12,\n        md: 12,\n        lg: 8,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 29\n        }\n      }, __jsx(Title, {\n        id: id,\n        number: number,\n        name: name,\n        chapters: chapters,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 33\n        }\n      }));\n    })));\n  } else {\n    return __jsx(\"div\", {\n      className: classes.section,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 16\n      }\n    }, __jsx(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 13\n      }\n    }, \"Loading...\"));\n  }\n}","map":{"version":3,"sources":["/home/charlie/MEGAsync/Ingenieria Sistemas/DECIMO SEMESTRE/Etica/app-ley842/pages-sections/LandingPage-Sections/user/LawSection.tsx"],"names":["React","useState","makeStyles","GridContainer","GridItem","Button","styles","FormControl","FormControlLabel","RadioGroup","Radio","CustomInput","Search","Title","executeQuery","searchQuery","searchTitleQuery","searchChapterQuery","searchArticleQuery","map","forEach","get","findIndex","unionBy","fetch","API_URL","CLIENT_ID","useStyles","SearchValue","searchLawContent","data","titles","LawSection","classes","searchValue","setSearchValue","TITLE","setSearchQuery","searchText","setSearchText","searched","setSearched","handleRadioChange","event","value","target","CHAPTER","ARTICLE","handlerSearch","response","method","body","JSON","stringify","query","variables","text","headers","then","res","json","setData","chapters","chapter","index","id","title","setChapterData","article","articles","indexTitle","error","console","log","message","handlerSearchText","section","label","root","labelRoot","fullWidth","searchIcon","gridScroll","number","name"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\n// @material-ui/core components\nimport { makeStyles } from \"@material-ui/core/styles\";\n\n// core components\nimport GridContainer from \"../../../components/Grid/GridContainer\";\nimport GridItem from \"../../../components/Grid/GridItem\";\nimport Button from \"../../../components/Button\";\n\nimport styles from \"../../../assets/jss/nextjs-material-kit/pages/landingPageSections/user/lawStyles\";\nimport {\n    FormControl,\n    FormControlLabel,\n    RadioGroup,\n    Radio,\n} from \"@material-ui/core\";\nimport CustomInput from \"../../../components/CustomInput\";\nimport { Search } from \"@material-ui/icons\";\nimport Title, { ITitle } from \"../../../components/etihcs/Title\";\nimport {executeQuery} from \"../../../plugins/graphqlQueryRequest\";\nimport { searchQuery } from \"../../../utils/queries\";\nimport { searchTitleQuery, searchChapterQuery, searchArticleQuery } from '../../../utils/queries'\nimport { map, forEach, get, findIndex, unionBy, unset } from \"lodash\";\nimport fetch from 'node-fetch';\nimport { API_URL, CLIENT_ID } from \"../../../utils/constants\";\n\nconst useStyles = makeStyles(styles as any);\n\nenum SearchValue{\n    TITLE = 'title',\n    CHAPTER = 'chapter',\n    ARTICLE = 'article'\n}\n\nconst searchLawContent = (): any => {\n    const { data } = executeQuery( searchQuery )\n    if( data && data.titles ) {\n        return data.titles\n    }\n}\n\nexport default function LawSection() {\n    const classes = useStyles();\n    const [searchValue, setSearchValue] = useState( SearchValue.TITLE );\n    const [searchQuery, setSearchQuery] = useState( searchTitleQuery );\n    const [searchText, setSearchText] = useState<String>( '' )\n    const [searched, setSearched] = useState<any> ( searchLawContent() )\n\n    const handleRadioChange = (event: React.ChangeEvent<HTMLInputElement>) => {\n        const value: string = (event.target as HTMLInputElement).value\n        if( value === SearchValue.TITLE  )\n            setSearchQuery( searchTitleQuery )\n        else if( value === SearchValue.CHAPTER )\n            setSearchQuery( searchChapterQuery )\n        else if( value === SearchValue.ARTICLE )\n            setSearchQuery( searchArticleQuery )\n        setSearchValue( value as SearchValue )\n    };\n\n    const handlerSearch = async () => {\n        try {\n            const response = await fetch( `${API_URL}`, {\n                method: 'POST',\n                body: JSON.stringify({\n                    query: searchQuery,\n                    variables: { text: searchText }\n                }),\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                    'Authorization': `client_id ${CLIENT_ID}`\n                }\n            } ).then( (res) => res.json() )\n            if( response.data ){\n                const data = response.data\n                if( searchValue === SearchValue.TITLE )\n                    setSearched( data.titles )\n                else if( searchValue === SearchValue.CHAPTER ) {\n                    let setData: Array<any> = []\n                    forEach(data.chapters, (chapter) => {\n                        if ( get(chapter, `title.id`) ) {\n                            const index = findIndex(setData, {id: get(chapter, `title.id`)})\n                            if (index !== -1)\n                                setData[index].chapters = unionBy(setData[index].chapters, [{...chapter}], 'id')\n                            else\n                                setData = unionBy(setData, [{...chapter.title, chapters: [{...chapter}]}], 'id')\n                        }\n                    })\n                    setSearched(setData)\n                } else if( searchValue === SearchValue.ARTICLE ) {\n\n                    const setChapterData = (chapters: Array<any>, article: any) => {\n                        const index = findIndex(chapters, {id: get(article, `chapter.id`)})\n                        if (index !== -1) {\n                            chapters[index].articles = unionBy(chapters[index].articles, [{...article}], 'id')\n                            return chapters\n                        } else\n                            return unionBy(chapters, [{...article.chapter, articles: [{...article}]}], 'id')\n                    }\n\n                    let setData: Array<any> = []\n                    forEach(data.articles, (article) => {\n                        if( get(article, `chapter.title.id`) ) {\n                            const indexTitle = findIndex(setData, {id: get(article, `chapter.title.id`)})\n                            if (indexTitle !== -1)\n                                setData[indexTitle].chapters = setChapterData(setData[indexTitle].chapters, article)\n                            else\n                                setData = unionBy(setData, [{\n                                    ...article.chapter.title,\n                                    chapters: setChapterData([], article)\n                                }], 'id')\n                        }\n                    })\n                    setSearched(setData)\n                }\n            }\n        } catch ( error ){\n            console.log( 'Error: ', error.message )\n        }\n    }\n    const handlerSearchText = (event: React.ChangeEvent<HTMLInputElement>) => {\n        setSearchText( event.target.value )\n    }\n\n    if( searched ) {\n        return (\n            <div className={classes.section}>\n                <h1 className={classes.title}>Búsqueda</h1>\n                <GridContainer justify=\"center\">\n                    <GridItem xs={12} sm={12} md={8}>\n                        <FormControl component=\"fieldset\">\n                            <RadioGroup row aria-label=\"search\" name=\"search\" value={searchValue}\n                                        onChange={handleRadioChange}>\n                                <FormControlLabel\n                                    value=\"title\"\n                                    control={<Radio/>}\n                                    label=\"Titulo\"\n                                    labelPlacement=\"bottom\"\n                                    classes={{\n                                        label: classes.label,\n                                        root: classes.labelRoot\n                                    }}\n                                />\n                                <FormControlLabel\n                                    value=\"chapter\"\n                                    control={<Radio/>}\n                                    label=\"Capitulo\"\n                                    labelPlacement=\"bottom\"\n                                    classes={{\n                                        label: classes.label,\n                                        root: classes.labelRoot\n                                    }}\n                                />\n                                <FormControlLabel\n                                    value=\"article\"\n                                    control={<Radio/>}\n                                    label=\"Articulo\"\n                                    labelPlacement=\"bottom\"\n                                    classes={{\n                                        label: classes.label,\n                                        root: classes.labelRoot\n                                    }}\n                                />\n                            </RadioGroup>\n                        </FormControl>\n                    </GridItem>\n                </GridContainer>\n                <GridContainer justify=\"center\">\n                    <GridItem xs={12} sm={12} md={12} lg={4}>\n                        <CustomInput\n                            labelText=\"Búscar\"\n                            id=\"material\"\n                            onChange={handlerSearchText}\n                            formControlProps={{\n                                fullWidth: true\n                            }}\n                        />\n                        <Button justIcon round color=\"white\" onClick={handlerSearch}>\n                            <Search className={classes.searchIcon}/>\n                        </Button>\n                    </GridItem>\n                </GridContainer>\n                <GridContainer className={classes.gridScroll} justify=\"center\">\n                    {map(searched, ({id, number, name, chapters}: ITitle) => {\n                        return (\n                            <GridItem key={id} xs={12} sm={12} md={12} lg={8}>\n                                <Title id={id} number={number} name={name} chapters={chapters}/>\n                            </GridItem>\n                        )\n                    })}\n                </GridContainer>\n            </div>\n        );\n    } else {\n        return <div className={classes.section}>\n            <h1>Loading...</h1>\n        </div>\n    }\n}\n"]},"metadata":{},"sourceType":"module"}