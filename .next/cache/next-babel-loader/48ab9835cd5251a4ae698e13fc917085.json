{"ast":null,"code":"var _jsxFileName = \"/home/charlie/MEGAsync/Ingenieria Sistemas/DECIMO SEMESTRE/Etica/app-ley842/pages-sections/LandingPage-Sections/user/LawSection.jsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from \"react\"; // @material-ui/core components\n\nimport { makeStyles } from \"@material-ui/core/styles\"; // core components\n\nimport GridContainer from \"../../../components/Grid/GridContainer\";\nimport GridItem from \"../../../components/Grid/GridItem\";\nimport Button from \"../../../components/Button\";\nimport styles from \"../../../assets/jss/nextjs-material-kit/pages/landingPageSections/user/lawStyles\";\nimport { FormControl, FormControlLabel, RadioGroup, Radio, CircularProgress } from \"@material-ui/core\";\nimport CustomInput from \"../../../components/CustomInput\";\nimport { Search } from \"@material-ui/icons\";\nimport Title from \"../../../components/etihcs/Title\";\nimport { executeQuery } from \"../../../plugins/graphqlQueryRequest\";\nimport { searchQuery } from \"../../../utils/queries\";\nimport { searchTitleQuery, searchChapterQuery, searchArticleQuery } from '../../../utils/queries';\nimport { map, forEach, get, findIndex, unionBy, isEmpty } from \"lodash\";\nimport fetch from 'node-fetch';\nimport { API_URL, CLIENT_ID } from \"../../../utils/constants\";\nconst useStyles = makeStyles(styles);\nconst TITLE = 'title';\nconst CHAPTER = 'chapter';\nconst ARTICLE = 'article';\n\nconst searchLawContent = () => {\n  const {\n    data\n  } = executeQuery(searchQuery);\n\n  if (data && data.titles) {\n    return data.titles;\n  }\n};\n\nexport default function LawSection() {\n  const classes = useStyles();\n  const {\n    0: searchValue,\n    1: setSearchValue\n  } = useState(TITLE);\n  const {\n    0: searchQuery,\n    1: setSearchQuery\n  } = useState(searchTitleQuery);\n  const {\n    0: searchText,\n    1: setSearchText\n  } = useState('');\n  const {\n    0: searched,\n    1: setSearched\n  } = useState(searchLawContent());\n  const [loading, setLoading] = React.useState(false);\n\n  const handleRadioChange = event => {\n    const value = event.target.value;\n    if (value === TITLE) setSearchQuery(searchTitleQuery);else if (value === CHAPTER) setSearchQuery(searchChapterQuery);else if (value === ARTICLE) setSearchQuery(searchArticleQuery);\n    setSearchValue(value);\n  };\n\n  const handlerSearch = async () => {\n    try {\n      setLoading(true);\n      const response = await fetch(`${API_URL}`, {\n        method: 'POST',\n        body: JSON.stringify({\n          query: searchQuery,\n          variables: {\n            text: searchText\n          }\n        }),\n        headers: {\n          'Content-Type': 'application/json',\n          'Accept': 'application/json',\n          'Authorization': `client_id ${CLIENT_ID}`\n        }\n      }).then(res => res.json());\n\n      if (response.data) {\n        const data = response.data;\n        if (searchValue === TITLE) setSearched(data.titles);else if (searchValue === CHAPTER) {\n          let setData = [];\n          forEach(data.chapters, chapter => {\n            if (get(chapter, `title.id`)) {\n              const index = findIndex(setData, {\n                id: get(chapter, `title.id`)\n              });\n              if (index !== -1) setData[index].chapters = unionBy(setData[index].chapters, [_objectSpread({}, chapter)], 'id');else setData = unionBy(setData, [_objectSpread({}, chapter.title, {\n                chapters: [_objectSpread({}, chapter)]\n              })], 'id');\n            }\n          });\n          setSearched(setData);\n        } else if (searchValue === ARTICLE) {\n          const setChapterData = (chapters, article) => {\n            const index = findIndex(chapters, {\n              id: get(article, `chapter.id`)\n            });\n\n            if (index !== -1) {\n              chapters[index].articles = unionBy(chapters[index].articles, [_objectSpread({}, article)], 'id');\n              return chapters;\n            } else return unionBy(chapters, [_objectSpread({}, article.chapter, {\n              articles: [_objectSpread({}, article)]\n            })], 'id');\n          };\n\n          let setData = [];\n          forEach(data.articles, article => {\n            if (get(article, `chapter.title.id`)) {\n              const indexTitle = findIndex(setData, {\n                id: get(article, `chapter.title.id`)\n              });\n              if (indexTitle !== -1) setData[indexTitle].chapters = setChapterData(setData[indexTitle].chapters, article);else setData = unionBy(setData, [_objectSpread({}, article.chapter.title, {\n                chapters: setChapterData([], article)\n              })], 'id');\n            }\n          });\n          setSearched(setData);\n        }\n      }\n\n      setLoading(false);\n    } catch (error) {\n      console.log('=> Error: ', error.message);\n    }\n  };\n\n  const handlerSearchText = event => {\n    setSearchText(event.target.value);\n  };\n\n  if (searched) {\n    return __jsx(\"div\", {\n      className: classes.section,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128,\n        columnNumber: 13\n      }\n    }, __jsx(\"h2\", {\n      className: classes.title,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 17\n      }\n    }, \"B\\xFAsqueda\"), __jsx(GridContainer, {\n      justify: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 130,\n        columnNumber: 17\n      }\n    }, __jsx(GridItem, {\n      xs: 12,\n      sm: 12,\n      md: 8,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 131,\n        columnNumber: 21\n      }\n    }, __jsx(FormControl, {\n      component: \"fieldset\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 25\n      }\n    }, __jsx(RadioGroup, {\n      row: true,\n      \"aria-label\": \"search\",\n      name: \"search\",\n      value: searchValue,\n      onChange: handleRadioChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 29\n      }\n    }, __jsx(FormControlLabel, {\n      value: \"title\",\n      control: __jsx(Radio, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 46\n        }\n      }),\n      label: \"Titulo\",\n      labelPlacement: \"bottom\",\n      classes: {\n        label: classes.label,\n        root: classes.labelRoot\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 135,\n        columnNumber: 33\n      }\n    }), __jsx(FormControlLabel, {\n      value: \"chapter\",\n      control: __jsx(Radio, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 46\n        }\n      }),\n      label: \"Capitulo\",\n      labelPlacement: \"bottom\",\n      classes: {\n        label: classes.label,\n        root: classes.labelRoot\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 33\n      }\n    }), __jsx(FormControlLabel, {\n      value: \"article\",\n      control: __jsx(Radio, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 46\n        }\n      }),\n      label: \"Articulo\",\n      labelPlacement: \"bottom\",\n      classes: {\n        label: classes.label,\n        root: classes.labelRoot\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 33\n      }\n    }))))), __jsx(GridContainer, {\n      justify: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 17\n      }\n    }, __jsx(GridItem, {\n      xs: 12,\n      sm: 12,\n      md: 12,\n      lg: 4,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 21\n      }\n    }, __jsx(CustomInput, {\n      labelText: \"B\\xFAscar\",\n      id: \"material\",\n      onChange: handlerSearchText,\n      formControlProps: {\n        fullWidth: true\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 25\n      }\n    }), __jsx(\"div\", {\n      className: classes.wrapper,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 25\n      }\n    }, __jsx(Button, {\n      disabled: loading,\n      justIcon: true,\n      round: true,\n      color: \"rose\",\n      onClick: handlerSearch,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 29\n      }\n    }, __jsx(Search, {\n      className: classes.searchIcon,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 33\n      }\n    })), loading && __jsx(CircularProgress, {\n      size: 24,\n      className: classes.buttonProgress,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 41\n      }\n    })))), __jsx(GridContainer, {\n      className: classes.gridScroll,\n      justify: \"center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 187,\n        columnNumber: 17\n      }\n    }, (() => {\n      if (isEmpty(searched)) return __jsx(GridItem, {\n        xs: 12,\n        sm: 12,\n        md: 12,\n        lg: 8,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 191,\n          columnNumber: 33\n        }\n      }, __jsx(\"h3\", {\n        className: classes.title,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 37\n        }\n      }, \"\\\"No se encontraron concidencias\\\"\"));else return map(searched, ({\n        id,\n        number,\n        name,\n        chapters\n      }) => {\n        return __jsx(GridItem, {\n          key: id,\n          xs: 12,\n          sm: 12,\n          md: 12,\n          lg: 8,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 37\n          }\n        }, __jsx(Title, {\n          id: id,\n          number: number,\n          name: name,\n          chapters: chapters,\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 199,\n            columnNumber: 41\n          }\n        }));\n      });\n    })()));\n  } else {\n    return __jsx(\"div\", {\n      className: classes.section,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 16\n      }\n    }, __jsx(\"h1\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 210,\n        columnNumber: 13\n      }\n    }, \"Loading...\"));\n  }\n}","map":{"version":3,"sources":["/home/charlie/MEGAsync/Ingenieria Sistemas/DECIMO SEMESTRE/Etica/app-ley842/pages-sections/LandingPage-Sections/user/LawSection.jsx"],"names":["React","useState","makeStyles","GridContainer","GridItem","Button","styles","FormControl","FormControlLabel","RadioGroup","Radio","CircularProgress","CustomInput","Search","Title","executeQuery","searchQuery","searchTitleQuery","searchChapterQuery","searchArticleQuery","map","forEach","get","findIndex","unionBy","isEmpty","fetch","API_URL","CLIENT_ID","useStyles","TITLE","CHAPTER","ARTICLE","searchLawContent","data","titles","LawSection","classes","searchValue","setSearchValue","setSearchQuery","searchText","setSearchText","searched","setSearched","loading","setLoading","handleRadioChange","event","value","target","handlerSearch","response","method","body","JSON","stringify","query","variables","text","headers","then","res","json","setData","chapters","chapter","index","id","title","setChapterData","article","articles","indexTitle","error","console","log","message","handlerSearchText","section","label","root","labelRoot","fullWidth","wrapper","searchIcon","buttonProgress","gridScroll","number","name"],"mappings":";;;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,QAA+B,OAA/B,C,CACA;;AACA,SAASC,UAAT,QAA2B,0BAA3B,C,CAEA;;AACA,OAAOC,aAAP,MAA0B,wCAA1B;AACA,OAAOC,QAAP,MAAqB,mCAArB;AACA,OAAOC,MAAP,MAAmB,4BAAnB;AAEA,OAAOC,MAAP,MAAmB,kFAAnB;AACA,SACIC,WADJ,EAEIC,gBAFJ,EAGIC,UAHJ,EAIIC,KAJJ,EAIWC,gBAJX,QAKO,mBALP;AAMA,OAAOC,WAAP,MAAwB,iCAAxB;AACA,SAASC,MAAT,QAAuB,oBAAvB;AACA,OAAOC,KAAP,MAAkB,kCAAlB;AACA,SAAQC,YAAR,QAA2B,sCAA3B;AACA,SAASC,WAAT,QAA4B,wBAA5B;AACA,SAASC,gBAAT,EAA2BC,kBAA3B,EAA+CC,kBAA/C,QAAyE,wBAAzE;AACA,SAAQC,GAAR,EAAaC,OAAb,EAAsBC,GAAtB,EAA2BC,SAA3B,EAAsCC,OAAtC,EAA+CC,OAA/C,QAA6D,QAA7D;AACA,OAAOC,KAAP,MAAkB,YAAlB;AACA,SAASC,OAAT,EAAkBC,SAAlB,QAAmC,0BAAnC;AAEA,MAAMC,SAAS,GAAG3B,UAAU,CAACI,MAAD,CAA5B;AAEA,MAAMwB,KAAK,GAAG,OAAd;AACA,MAAOC,OAAO,GAAG,SAAjB;AACA,MAAMC,OAAO,GAAG,SAAhB;;AAEA,MAAMC,gBAAgB,GAAG,MAAM;AAC3B,QAAM;AAAEC,IAAAA;AAAF,MAAWnB,YAAY,CAAEC,WAAF,CAA7B;;AACA,MAAIkB,IAAI,IAAIA,IAAI,CAACC,MAAjB,EAA0B;AACtB,WAAOD,IAAI,CAACC,MAAZ;AACH;AACJ,CALD;;AAOA,eAAe,SAASC,UAAT,GAAsB;AACjC,QAAMC,OAAO,GAAGR,SAAS,EAAzB;AACA,QAAM;AAAA,OAACS,WAAD;AAAA,OAAcC;AAAd,MAAgCtC,QAAQ,CAAE6B,KAAF,CAA9C;AACA,QAAM;AAAA,OAACd,WAAD;AAAA,OAAcwB;AAAd,MAAgCvC,QAAQ,CAAEgB,gBAAF,CAA9C;AACA,QAAM;AAAA,OAACwB,UAAD;AAAA,OAAaC;AAAb,MAA8BzC,QAAQ,CAAE,EAAF,CAA5C;AACA,QAAM;AAAA,OAAC0C,QAAD;AAAA,OAAWC;AAAX,MAA0B3C,QAAQ,CAAGgC,gBAAgB,EAAnB,CAAxC;AACA,QAAM,CAACY,OAAD,EAAUC,UAAV,IAAwB9C,KAAK,CAACC,QAAN,CAAe,KAAf,CAA9B;;AAEA,QAAM8C,iBAAiB,GAAIC,KAAD,IAAW;AACjC,UAAMC,KAAK,GAAID,KAAK,CAACE,MAAP,CAAeD,KAA7B;AACA,QAAIA,KAAK,KAAKnB,KAAd,EACIU,cAAc,CAAEvB,gBAAF,CAAd,CADJ,KAEK,IAAIgC,KAAK,KAAKlB,OAAd,EACDS,cAAc,CAAEtB,kBAAF,CAAd,CADC,KAEA,IAAI+B,KAAK,KAAKjB,OAAd,EACDQ,cAAc,CAAErB,kBAAF,CAAd;AACJoB,IAAAA,cAAc,CAAEU,KAAF,CAAd;AACH,GATD;;AAWA,QAAME,aAAa,GAAG,YAAY;AAC9B,QAAI;AACAL,MAAAA,UAAU,CAAE,IAAF,CAAV;AACA,YAAMM,QAAQ,GAAG,MAAM1B,KAAK,CAAG,GAAEC,OAAQ,EAAb,EAAgB;AACxC0B,QAAAA,MAAM,EAAE,MADgC;AAExCC,QAAAA,IAAI,EAAEC,IAAI,CAACC,SAAL,CAAe;AACjBC,UAAAA,KAAK,EAAEzC,WADU;AAEjB0C,UAAAA,SAAS,EAAE;AAAEC,YAAAA,IAAI,EAAElB;AAAR;AAFM,SAAf,CAFkC;AAMxCmB,QAAAA,OAAO,EAAE;AACL,0BAAgB,kBADX;AAEL,oBAAU,kBAFL;AAGL,2BAAkB,aAAYhC,SAAU;AAHnC;AAN+B,OAAhB,CAAL,CAWnBiC,IAXmB,CAWZC,GAAD,IAASA,GAAG,CAACC,IAAJ,EAXI,CAAvB;;AAYA,UAAIX,QAAQ,CAAClB,IAAb,EAAmB;AACf,cAAMA,IAAI,GAAGkB,QAAQ,CAAClB,IAAtB;AACA,YAAII,WAAW,KAAKR,KAApB,EACIc,WAAW,CAAEV,IAAI,CAACC,MAAP,CAAX,CADJ,KAEK,IAAIG,WAAW,KAAKP,OAApB,EAA8B;AAC/B,cAAIiC,OAAO,GAAG,EAAd;AACA3C,UAAAA,OAAO,CAACa,IAAI,CAAC+B,QAAN,EAAiBC,OAAD,IAAa;AAChC,gBAAK5C,GAAG,CAAC4C,OAAD,EAAW,UAAX,CAAR,EAAgC;AAC5B,oBAAMC,KAAK,GAAG5C,SAAS,CAACyC,OAAD,EAAU;AAACI,gBAAAA,EAAE,EAAE9C,GAAG,CAAC4C,OAAD,EAAW,UAAX;AAAR,eAAV,CAAvB;AACA,kBAAIC,KAAK,KAAK,CAAC,CAAf,EACIH,OAAO,CAACG,KAAD,CAAP,CAAeF,QAAf,GAA0BzC,OAAO,CAACwC,OAAO,CAACG,KAAD,CAAP,CAAeF,QAAhB,EAA0B,mBAAKC,OAAL,EAA1B,EAA0C,IAA1C,CAAjC,CADJ,KAGIF,OAAO,GAAGxC,OAAO,CAACwC,OAAD,EAAU,mBAAKE,OAAO,CAACG,KAAb;AAAoBJ,gBAAAA,QAAQ,EAAE,mBAAKC,OAAL;AAA9B,iBAAV,EAA0D,IAA1D,CAAjB;AACP;AACJ,WARM,CAAP;AASAtB,UAAAA,WAAW,CAACoB,OAAD,CAAX;AACH,SAZI,MAYE,IAAI1B,WAAW,KAAKN,OAApB,EAA8B;AAEjC,gBAAMsC,cAAc,GAAG,CAACL,QAAD,EAAWM,OAAX,KAAuB;AAC1C,kBAAMJ,KAAK,GAAG5C,SAAS,CAAC0C,QAAD,EAAW;AAACG,cAAAA,EAAE,EAAE9C,GAAG,CAACiD,OAAD,EAAW,YAAX;AAAR,aAAX,CAAvB;;AACA,gBAAIJ,KAAK,KAAK,CAAC,CAAf,EAAkB;AACdF,cAAAA,QAAQ,CAACE,KAAD,CAAR,CAAgBK,QAAhB,GAA2BhD,OAAO,CAACyC,QAAQ,CAACE,KAAD,CAAR,CAAgBK,QAAjB,EAA2B,mBAAKD,OAAL,EAA3B,EAA2C,IAA3C,CAAlC;AACA,qBAAON,QAAP;AACH,aAHD,MAII,OAAOzC,OAAO,CAACyC,QAAD,EAAW,mBAAKM,OAAO,CAACL,OAAb;AAAsBM,cAAAA,QAAQ,EAAE,mBAAKD,OAAL;AAAhC,eAAX,EAA6D,IAA7D,CAAd;AACP,WAPD;;AASA,cAAIP,OAAO,GAAG,EAAd;AACA3C,UAAAA,OAAO,CAACa,IAAI,CAACsC,QAAN,EAAiBD,OAAD,IAAa;AAChC,gBAAIjD,GAAG,CAACiD,OAAD,EAAW,kBAAX,CAAP,EAAuC;AACnC,oBAAME,UAAU,GAAGlD,SAAS,CAACyC,OAAD,EAAU;AAACI,gBAAAA,EAAE,EAAE9C,GAAG,CAACiD,OAAD,EAAW,kBAAX;AAAR,eAAV,CAA5B;AACA,kBAAIE,UAAU,KAAK,CAAC,CAApB,EACIT,OAAO,CAACS,UAAD,CAAP,CAAoBR,QAApB,GAA+BK,cAAc,CAACN,OAAO,CAACS,UAAD,CAAP,CAAoBR,QAArB,EAA+BM,OAA/B,CAA7C,CADJ,KAGIP,OAAO,GAAGxC,OAAO,CAACwC,OAAD,EAAU,mBACpBO,OAAO,CAACL,OAAR,CAAgBG,KADI;AAEvBJ,gBAAAA,QAAQ,EAAEK,cAAc,CAAC,EAAD,EAAKC,OAAL;AAFD,iBAAV,EAGb,IAHa,CAAjB;AAIP;AACJ,WAXM,CAAP;AAYA3B,UAAAA,WAAW,CAACoB,OAAD,CAAX;AACH;AACJ;;AACDlB,MAAAA,UAAU,CAAE,KAAF,CAAV;AACH,KA1DD,CA0DE,OAAQ4B,KAAR,EAAe;AACbC,MAAAA,OAAO,CAACC,GAAR,CAAa,YAAb,EAA2BF,KAAK,CAACG,OAAjC;AACH;AACJ,GA9DD;;AA+DA,QAAMC,iBAAiB,GAAI9B,KAAD,IAAW;AACjCN,IAAAA,aAAa,CAAEM,KAAK,CAACE,MAAN,CAAaD,KAAf,CAAb;AACH,GAFD;;AAIA,MAAIN,QAAJ,EAAe;AACX,WACI;AAAK,MAAA,SAAS,EAAEN,OAAO,CAAC0C,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI;AAAI,MAAA,SAAS,EAAE1C,OAAO,CAACgC,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBADJ,EAEI,MAAC,aAAD;AAAe,MAAA,OAAO,EAAC,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,QAAD;AAAU,MAAA,EAAE,EAAE,EAAd;AAAkB,MAAA,EAAE,EAAE,EAAtB;AAA0B,MAAA,EAAE,EAAE,CAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,WAAD;AAAa,MAAA,SAAS,EAAC,UAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,UAAD;AAAY,MAAA,GAAG,MAAf;AAAgB,oBAAW,QAA3B;AAAoC,MAAA,IAAI,EAAC,QAAzC;AAAkD,MAAA,KAAK,EAAE/B,WAAzD;AACY,MAAA,QAAQ,EAAES,iBADtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAEI,MAAC,gBAAD;AACI,MAAA,KAAK,EAAC,OADV;AAEI,MAAA,OAAO,EAAE,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFb;AAGI,MAAA,KAAK,EAAC,QAHV;AAII,MAAA,cAAc,EAAC,QAJnB;AAKI,MAAA,OAAO,EAAE;AACLiC,QAAAA,KAAK,EAAE3C,OAAO,CAAC2C,KADV;AAELC,QAAAA,IAAI,EAAE5C,OAAO,CAAC6C;AAFT,OALb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAFJ,EAYI,MAAC,gBAAD;AACI,MAAA,KAAK,EAAC,SADV;AAEI,MAAA,OAAO,EAAE,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFb;AAGI,MAAA,KAAK,EAAC,UAHV;AAII,MAAA,cAAc,EAAC,QAJnB;AAKI,MAAA,OAAO,EAAE;AACLF,QAAAA,KAAK,EAAE3C,OAAO,CAAC2C,KADV;AAELC,QAAAA,IAAI,EAAE5C,OAAO,CAAC6C;AAFT,OALb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAZJ,EAsBI,MAAC,gBAAD;AACI,MAAA,KAAK,EAAC,SADV;AAEI,MAAA,OAAO,EAAE,MAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAFb;AAGI,MAAA,KAAK,EAAC,UAHV;AAII,MAAA,cAAc,EAAC,QAJnB;AAKI,MAAA,OAAO,EAAE;AACLF,QAAAA,KAAK,EAAE3C,OAAO,CAAC2C,KADV;AAELC,QAAAA,IAAI,EAAE5C,OAAO,CAAC6C;AAFT,OALb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAtBJ,CADJ,CADJ,CADJ,CAFJ,EAyCI,MAAC,aAAD;AAAe,MAAA,OAAO,EAAC,QAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,QAAD;AAAU,MAAA,EAAE,EAAE,EAAd;AAAkB,MAAA,EAAE,EAAE,EAAtB;AAA0B,MAAA,EAAE,EAAE,EAA9B;AAAkC,MAAA,EAAE,EAAE,CAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,WAAD;AACI,MAAA,SAAS,EAAC,WADd;AAEI,MAAA,EAAE,EAAC,UAFP;AAGI,MAAA,QAAQ,EAAEJ,iBAHd;AAII,MAAA,gBAAgB,EAAE;AACdK,QAAAA,SAAS,EAAE;AADG,OAJtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,EASI;AAAK,MAAA,SAAS,EAAE9C,OAAO,CAAC+C,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,MAAD;AAAQ,MAAA,QAAQ,EAAEvC,OAAlB;AAA2B,MAAA,QAAQ,MAAnC;AAAoC,MAAA,KAAK,MAAzC;AAA0C,MAAA,KAAK,EAAC,MAAhD;AAAuD,MAAA,OAAO,EAAEM,aAAhE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACI,MAAC,MAAD;AAAQ,MAAA,SAAS,EAAEd,OAAO,CAACgD,UAA3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MADJ,CADJ,EAIKxC,OAAO,IAAI,MAAC,gBAAD;AAAkB,MAAA,IAAI,EAAE,EAAxB;AAA4B,MAAA,SAAS,EAAER,OAAO,CAACiD,cAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAJhB,CATJ,CADJ,CAzCJ,EA2DI,MAAC,aAAD;AAAe,MAAA,SAAS,EAAEjD,OAAO,CAACkD,UAAlC;AAA8C,MAAA,OAAO,EAAC,QAAtD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACK,CAAC,MAAM;AACJ,UAAI9D,OAAO,CAACkB,QAAD,CAAX,EACI,OACI,MAAC,QAAD;AAAU,QAAA,EAAE,EAAE,EAAd;AAAkB,QAAA,EAAE,EAAE,EAAtB;AAA0B,QAAA,EAAE,EAAE,EAA9B;AAAkC,QAAA,EAAE,EAAE,CAAtC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACI;AAAI,QAAA,SAAS,EAAEN,OAAO,CAACgC,KAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CADJ,CADJ,CADJ,KAOI,OAAOjD,GAAG,CAACuB,QAAD,EAAW,CAAC;AAACyB,QAAAA,EAAD;AAAKoB,QAAAA,MAAL;AAAaC,QAAAA,IAAb;AAAmBxB,QAAAA;AAAnB,OAAD,KAAkC;AACnD,eACI,MAAC,QAAD;AAAU,UAAA,GAAG,EAAEG,EAAf;AAAmB,UAAA,EAAE,EAAE,EAAvB;AAA2B,UAAA,EAAE,EAAE,EAA/B;AAAmC,UAAA,EAAE,EAAE,EAAvC;AAA2C,UAAA,EAAE,EAAE,CAA/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,WACI,MAAC,KAAD;AAAO,UAAA,EAAE,EAAEA,EAAX;AAAe,UAAA,MAAM,EAAEoB,MAAvB;AAA+B,UAAA,IAAI,EAAEC,IAArC;AAA2C,UAAA,QAAQ,EAAExB,QAArD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UADJ,CADJ;AAKH,OANS,CAAV;AAOP,KAfA,GADL,CA3DJ,CADJ;AAiFH,GAlFD,MAkFO;AACH,WAAO;AAAK,MAAA,SAAS,EAAE5B,OAAO,CAAC0C,OAAxB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADG,CAAP;AAGH;AACJ","sourcesContent":["import React, { useState} from \"react\";\n// @material-ui/core components\nimport { makeStyles } from \"@material-ui/core/styles\";\n\n// core components\nimport GridContainer from \"../../../components/Grid/GridContainer\";\nimport GridItem from \"../../../components/Grid/GridItem\";\nimport Button from \"../../../components/Button\";\n\nimport styles from \"../../../assets/jss/nextjs-material-kit/pages/landingPageSections/user/lawStyles\";\nimport {\n    FormControl,\n    FormControlLabel,\n    RadioGroup,\n    Radio, CircularProgress,\n} from \"@material-ui/core\";\nimport CustomInput from \"../../../components/CustomInput\";\nimport { Search } from \"@material-ui/icons\";\nimport Title from \"../../../components/etihcs/Title\";\nimport {executeQuery} from \"../../../plugins/graphqlQueryRequest\";\nimport { searchQuery } from \"../../../utils/queries\";\nimport { searchTitleQuery, searchChapterQuery, searchArticleQuery } from '../../../utils/queries'\nimport {map, forEach, get, findIndex, unionBy, isEmpty} from \"lodash\";\nimport fetch from 'node-fetch';\nimport { API_URL, CLIENT_ID } from \"../../../utils/constants\";\n\nconst useStyles = makeStyles(styles);\n\nconst TITLE = 'title'\nconst  CHAPTER = 'chapter'\nconst ARTICLE = 'article'\n\nconst searchLawContent = () => {\n    const { data } = executeQuery( searchQuery )\n    if( data && data.titles ) {\n        return data.titles\n    }\n}\n\nexport default function LawSection() {\n    const classes = useStyles();\n    const [searchValue, setSearchValue] = useState( TITLE );\n    const [searchQuery, setSearchQuery] = useState( searchTitleQuery );\n    const [searchText, setSearchText] = useState( '' )\n    const [searched, setSearched] = useState ( searchLawContent() )\n    const [loading, setLoading] = React.useState(false);\n\n    const handleRadioChange = (event) => {\n        const value = (event.target).value\n        if( value === TITLE  )\n            setSearchQuery( searchTitleQuery )\n        else if( value === CHAPTER )\n            setSearchQuery( searchChapterQuery )\n        else if( value === ARTICLE )\n            setSearchQuery( searchArticleQuery )\n        setSearchValue( value )\n    };\n\n    const handlerSearch = async () => {\n        try {\n            setLoading( true )\n            const response = await fetch( `${API_URL}`, {\n                method: 'POST',\n                body: JSON.stringify({\n                    query: searchQuery,\n                    variables: { text: searchText }\n                }),\n                headers: {\n                    'Content-Type': 'application/json',\n                    'Accept': 'application/json',\n                    'Authorization': `client_id ${CLIENT_ID}`\n                }\n            } ).then( (res) => res.json() )\n            if( response.data ){\n                const data = response.data\n                if( searchValue === TITLE )\n                    setSearched( data.titles )\n                else if( searchValue === CHAPTER ) {\n                    let setData = []\n                    forEach(data.chapters, (chapter) => {\n                        if ( get(chapter, `title.id`) ) {\n                            const index = findIndex(setData, {id: get(chapter, `title.id`)})\n                            if (index !== -1)\n                                setData[index].chapters = unionBy(setData[index].chapters, [{...chapter}], 'id')\n                            else\n                                setData = unionBy(setData, [{...chapter.title, chapters: [{...chapter}]}], 'id')\n                        }\n                    })\n                    setSearched(setData)\n                } else if( searchValue === ARTICLE ) {\n\n                    const setChapterData = (chapters, article) => {\n                        const index = findIndex(chapters, {id: get(article, `chapter.id`)})\n                        if (index !== -1) {\n                            chapters[index].articles = unionBy(chapters[index].articles, [{...article}], 'id')\n                            return chapters\n                        } else\n                            return unionBy(chapters, [{...article.chapter, articles: [{...article}]}], 'id')\n                    }\n\n                    let setData = []\n                    forEach(data.articles, (article) => {\n                        if( get(article, `chapter.title.id`) ) {\n                            const indexTitle = findIndex(setData, {id: get(article, `chapter.title.id`)})\n                            if (indexTitle !== -1)\n                                setData[indexTitle].chapters = setChapterData(setData[indexTitle].chapters, article)\n                            else\n                                setData = unionBy(setData, [{\n                                    ...article.chapter.title,\n                                    chapters: setChapterData([], article)\n                                }], 'id')\n                        }\n                    })\n                    setSearched(setData)\n                }\n            }\n            setLoading( false )\n        } catch ( error ){\n            console.log( '=> Error: ', error.message )\n        }\n    }\n    const handlerSearchText = (event) => {\n        setSearchText( event.target.value )\n    }\n\n    if( searched ) {\n        return (\n            <div className={classes.section}>\n                <h2 className={classes.title}>Búsqueda</h2>\n                <GridContainer justify=\"center\">\n                    <GridItem xs={12} sm={12} md={8}>\n                        <FormControl component=\"fieldset\">\n                            <RadioGroup row aria-label=\"search\" name=\"search\" value={searchValue}\n                                        onChange={handleRadioChange}>\n                                <FormControlLabel\n                                    value=\"title\"\n                                    control={<Radio/>}\n                                    label=\"Titulo\"\n                                    labelPlacement=\"bottom\"\n                                    classes={{\n                                        label: classes.label,\n                                        root: classes.labelRoot\n                                    }}\n                                />\n                                <FormControlLabel\n                                    value=\"chapter\"\n                                    control={<Radio/>}\n                                    label=\"Capitulo\"\n                                    labelPlacement=\"bottom\"\n                                    classes={{\n                                        label: classes.label,\n                                        root: classes.labelRoot\n                                    }}\n                                />\n                                <FormControlLabel\n                                    value=\"article\"\n                                    control={<Radio/>}\n                                    label=\"Articulo\"\n                                    labelPlacement=\"bottom\"\n                                    classes={{\n                                        label: classes.label,\n                                        root: classes.labelRoot\n                                    }}\n                                />\n                            </RadioGroup>\n                        </FormControl>\n                    </GridItem>\n                </GridContainer>\n                <GridContainer justify=\"center\">\n                    <GridItem xs={12} sm={12} md={12} lg={4}>\n                        <CustomInput\n                            labelText=\"Búscar\"\n                            id=\"material\"\n                            onChange={handlerSearchText}\n                            formControlProps={{\n                                fullWidth: true\n                            }}\n                        />\n                        <div className={classes.wrapper}>\n                            <Button disabled={loading} justIcon round color=\"rose\" onClick={handlerSearch}>\n                                <Search className={classes.searchIcon}/>\n                            </Button>\n                            {loading && <CircularProgress size={24} className={classes.buttonProgress} />}\n                        </div>\n                    </GridItem>\n                </GridContainer>\n                <GridContainer className={classes.gridScroll} justify=\"center\">\n                    {(() => {\n                        if( isEmpty(searched) )\n                            return (\n                                <GridItem xs={12} sm={12} md={12} lg={8}>\n                                    <h3 className={classes.title}>\"No se encontraron concidencias\"</h3>\n                                </GridItem>\n                            )\n                        else\n                            return map(searched, ({id, number, name, chapters}) => {\n                                return (\n                                    <GridItem key={id} xs={12} sm={12} md={12} lg={8}>\n                                        <Title id={id} number={number} name={name} chapters={chapters}/>\n                                    </GridItem>\n                                )\n                            })\n                    })()}\n\n                </GridContainer>\n            </div>\n        );\n    } else {\n        return <div className={classes.section}>\n            <h1>Loading...</h1>\n        </div>\n    }\n}\n"]},"metadata":{},"sourceType":"module"}